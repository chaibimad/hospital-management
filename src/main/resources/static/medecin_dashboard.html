<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Tableau de bord M√©decin</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f9; margin: 0; padding: 0; }
        .container { max-width: 1100px; margin: auto; }
        .header { background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 28px; border-radius: 14px; margin-bottom: 22px; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.25); }
        .kpi-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 18px; margin-bottom: 22px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.06); border: 1px solid #e1e8ed; }
        .kpi-title { color: #7f8c8d; font-weight: 700; font-size: 13px; text-transform: uppercase; }
        .kpi-value { font-size: 32px; font-weight: 800; color: #2c3e50; margin-top: 6px; }
        .actions { display:flex; flex-wrap: wrap; gap: 12px; }
        .btn { display:inline-block; padding: 10px 16px; background: #2ecc71; color: white; text-decoration: none; border-radius: 8px; font-weight: 700; }
        .btn:hover { background: #27ae60; }
        .btn-secondary { background: #3498db; }
        .btn-secondary:hover { background: #2980b9; }
        table { width: 100%; border-collapse: collapse; margin-top: 12px; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        th { color: #7f8c8d; font-size: 12px; text-transform: uppercase; }
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700; display:inline-block; }
        .badge-wait { background: #f1c40f; color: white; }
        .badge-ok { background: #2ecc71; color: white; }
        .badge-annule { background: #95a5a6; color: white; }
        .badge-termine { background: #3498db; color: white; }
        .btn-start { background:#27ae60; color:white; padding:6px 10px; border-radius: 6px; text-decoration:none; font-weight:700; }
        .btn-start:hover { background:#219a52; }
    </style>
</head>
<body>
    <div id="app-main" class="container">
        <div class="header">
            <h1 style="margin:0;">üë®‚Äç‚öïÔ∏è Tableau de bord M√©decin</h1>
            <p style="margin:8px 0 0 0; opacity:0.95;">Aper√ßu de votre journ√©e et acc√®s rapide aux outils cliniques.</p>
        </div>

        <div class="kpi-grid">
            <div class="card">
                <div class="kpi-title">Consultations pr√©vues aujourd'hui</div>
                <div class="kpi-value" th:text="${countToday}">0</div>
            </div>
            <div class="card">
                <div class="kpi-title">Acc√®s rapide</div>
                <div class="actions" style="margin-top:12px;">
                    <a class="btn btn-secondary" th:href="@{/medecin/agenda}">üóìÔ∏è Ouvrir l'agenda</a>
                </div>
            </div>
        </div>

        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
                <h3 style="margin:0;">üïí Rendez-vous d'aujourd'hui</h3>
                <a class="btn" th:href="@{/medecin/agenda}">Voir tout</a>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Heure</th>
                        <th>Patient</th>
                        <th>Motif</th>
                        <th>Statut</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="rdv : ${todayRdv}">
                        <td th:text="${#temporals.format(rdv.dateHeure, 'HH:mm')}">--:--</td>
                        <td th:text="${rdv.patient != null ? ('#' + rdv.patient.id + ' - ' + rdv.patient.nom + ' ' + rdv.patient.prenom) : '-'}">-</td>
                        <td th:text="${rdv.motif}">-</td>
                        <td>
                            <span th:class="${rdv.statut == 'CONFIRM√â' ? 'badge badge-ok' : (rdv.statut == 'ANNULE' ? 'badge badge-annule' : (rdv.statut == 'TERMINE' ? 'badge badge-termine' : 'badge badge-wait'))}" th:text="${rdv.statut}">EN_ATTENTE</span>
                        </td>
                        <td>
                            <a class="btn-start" th:href="@{/medecin/demarrer/{id}(id=${rdv.id})}">D√©marrer</a>
                        </td>
                    </tr>
                    <tr th:if="${todayRdv == null or #lists.isEmpty(todayRdv)}">
                        <td colspan="5" style="text-align:center; color:#95a5a6; padding:16px;">Aucun rendez-vous aujourd'hui.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
